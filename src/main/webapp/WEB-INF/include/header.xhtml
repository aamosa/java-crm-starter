<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
   xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
   xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
   xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions">

   <c:set var="p"
      value="${'/'+= fn:split(facesContext.externalContext.requestServletPath, '/')[0] += '/'}" />

   <div id="header-wrapper">
      <div id="nav-container">
         <div id="user-bar">
            <div class="fields">
               <ui:repeat value="#{menuBacking.menu}" var="m">
                  <h:link value="#{m.label}" outcome="#{m.value}"
                     styleClass="#{view.viewId eq p+=m.value ? 'selected tab' : 'tab'}" />
               </ui:repeat>
               <c:if test="#{not empty request.userPrincipal}">
                  <h:form>
                     <h:commandLink value="Logout" styleClass="tab" action="#{login.logout}" />
                  </h:form>
               </c:if>
            </div>
            <div class="fields right">Logged in as: #{request.userPrincipal.name}</div>
         </div>
      </div>
      <div id="header-block">
         <div id="header-container">
            <ui:insert name="header-stuff"></ui:insert>
         </div>
         <div>
            <h:form>
               <h:commandButton id="nbtn" value="Create New" action="#{contactBacking.create}" styleClass="tab"/>
            </h:form>
         </div>
      </div>
   </div>
</ui:composition>