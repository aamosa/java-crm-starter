<ui:composition template="/WEB-INF/template.xhtml" 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

  <ui:define name="title">Dashboard</ui:define>
  
  <ui:define name="header-stuff">
    <div class="fields">
      <h:form id="indexForm">
        <div class="header-dropdown selector">
          <label>Search Option:</label>
          <h:selectOneMenu id="searchOption" value="#{entityUserBean.searchOption}">
            <f:selectItem itemValue="search" itemLabel="Select search option" />
            <f:selectItem itemValue="searchByName" itemLabel="Search By Name" />
            <f:selectItem itemValue="searchByDate" itemLabel="Search By Date Range" />
            <f:selectItem itemValue="searchByID" itemLabel="Search By ID" />
            <f:selectItem itemValue="fetchAll" itemLabel="Display All" />

            <f:ajax event="change" execute="@this" render="searchOptionPanel" />
            <f:ajax listener="#{entityUserBean.refresh}" />
          </h:selectOneMenu>
        </div>

        <h:panelGroup layout="block" styleClass="header-dropdown" id="searchOptionPanel">
          <h:outputLabel id="firstNameLabel" for="fName"
            rendered="#{entityUserBean.searchOption eq 'searchByName'}">First Name:</h:outputLabel>
          <h:inputText id="fName" value="#{entityUserBean.firstName}" label="Contact Name:"
            rendered="#{entityUserBean.searchOption eq 'searchByName'}" required="false"
            styleClass="header-input" />

          <h:outputLabel id="lastNameLabel" for="lName"
            rendered="#{entityUserBean.searchOption eq 'searchByName'}">Last Name:</h:outputLabel>
          <h:inputText id="lName" value="#{entityUserBean.lastName}"
            rendered="#{entityUserBean.searchOption eq 'searchByName'}" required="true"
            requiredMessage="Name cannot be blank." styleClass="header-input" />

          <h:outputLabel for="searchDateFrom" rendered="#{entityUserBean.searchOption eq 'searchByDate'}">Search Date From:</h:outputLabel>
          <h:inputText id="searchDateFrom" value="#{entityUserBean.searchDateFrom}"
            label="Search Date From" styleClass="header-input" required="true"
            rendered="#{entityUserBean.searchOption eq 'searchByDate'}"
            requiredMessage="Please enter a valid date. For example 04/10/2019">
            <f:convertDateTime type="localDate" pattern="MM/dd/yyyy" />
          </h:inputText>

          <h:outputLabel for="searchDateTo" rendered="#{entityUserBean.searchOption eq 'searchByDate'}">Search Date To:</h:outputLabel>
          <h:inputText id="searchDateTo" value="#{entityUserBean.searchDateTo}" label="Search Date To"
            styleClass="header-input" rendered="#{entityUserBean.searchOption eq 'searchByDate'}">
            <f:convertDateTime type="localDate" pattern="MM/dd/yyyy" />
          </h:inputText>

          <h:outputLabel for="searchID" rendered="#{entityUserBean.searchOption eq 'searchByID'}">ID:</h:outputLabel>
          <h:inputText id="searchID" value="#{entityUserBean.customerID}" styleClass="header-input"
            required="true" rendered="#{entityUserBean.searchOption eq 'searchByID'}"
            requiredMessage="ID field cannot be blank." validatorMessage="Improper ID.">
            <f:validateLongRange minimum="1" maximum="1000000000" />
          </h:inputText>
        </h:panelGroup>

        <h:panelGroup layout="block" styleClass="header-dropdown search" id="searchButtonPanel">
          <h:commandButton styleClass="header-search tab" id="submitBtn" value="Search"
            action="#{entityUserBean.search}">
            <f:ajax execute="@form" render="@form :resultsPanel userMsgs grwl" />
          </h:commandButton>
          <h:commandButton styleClass="header-search tab" type="reset" id="resetBtn" value="Refresh" />
        </h:panelGroup>
      </h:form>
    </div>
  </ui:define>
  
  <ui:define name="content-stuff">
    <div class="table-wrapper">
      <h:panelGroup layout="block">
        <h:messages id="userMsgs" infoClass="info messages" errorClass="error messages" />
      </h:panelGroup>

      <h:panelGroup id="grwl" layout="block">
        <h:outputText value="No Matching Records Found."
          rendered="#{empty entityUserBean.values and !facesContext.validationFailed}"
          styleClass="alert messages" />
      </h:panelGroup>

      <h:panelGroup id="resultsPanel">
        <h:dataTable id="someTable" value="#{entityUserBean.values}" var="customer"
          rendered="#{!empty entityUserBean.values}" styleClass="data-table">
          <h:column>
            <f:facet name="header">
              <h:outputText value="ID" />
            </f:facet>
            <h:link outcome="customer" value="#{customer.customerID}" includeViewParams="true">
              <f:param name="custid" value="#{customer.customerID}" />
            </h:link>
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Status" />
            </f:facet>
            <h:outputText value="#{customer.statusCode}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="First Name" />
            </f:facet>
            <h:outputText value="#{customer.firstName}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Last Name" />
            </f:facet>
            <h:outputText value="#{customer.lastName}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Street Address" />
            </f:facet>
            <h:outputText value="#{customer.streetAddress}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="City" />
            </f:facet>
            <h:outputText value="#{customer.city}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="State" />
            </f:facet>
            <h:outputText value="#{customer.state}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Zipcode" />
            </f:facet>
            <h:outputText value="#{customer.zipCode}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Email" />
            </f:facet>
            <h:outputText value="#{customer.email}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Phone" />
            </f:facet>
            <h:outputText value="#{customer.phone}" />
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Created" />
            </f:facet>
            <h:outputText value="#{customer.createdTime}">
              <f:convertDateTime type="localDateTime" pattern="MM/dd/yyyy HH:mm:ss" />
            </h:outputText>
          </h:column>

          <h:column>
            <f:facet name="header">
              <h:outputText value="Last Updated" />
            </f:facet>
            <h:outputText value="#{customer.lastUpdatedTime}">
              <f:convertDateTime type="localDateTime" pattern="MM/dd/yyyy HH:mm:ss" />
            </h:outputText>
          </h:column>
        </h:dataTable>
      </h:panelGroup>
      
    </div>
  </ui:define>
</ui:composition>
