<ui:composition template="/WEB-INF/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:syn="http://syn.example.org/jsf">

  <ui:define name="title">Dashboard</ui:define>

  <ui:define name="header-stuff">
    <div class="fields">
      <h:form id="indexForm">
        <div class="header-dropdown selector">
          <h:outputLabel for="searchOption" value="Search Option:" />
          <h:selectOneMenu id="searchOption" value="#{searchBacking.searchOption}">
            <f:selectItem itemValue="search" itemLabel="Select search option" />
            <f:selectItem itemValue="searchByName" itemLabel="Search By Name" />
            <f:selectItem itemValue="searchByDate" itemLabel="Search By Date Range" />
            <f:selectItem itemValue="searchByID" itemLabel="Search By ID" />
            <f:selectItem itemValue="fetchAll" itemLabel="Display All" />

            <f:ajax event="change" execute="@this" render="searchOptionPanel" />
            <f:ajax listener="#{searchBacking.refresh}" />
          </h:selectOneMenu>
        </div>

        <h:panelGroup layout="block" styleClass="header-dropdown" id="searchOptionPanel">
          <syn:input id="fName" label="First Name" value="#{searchBacking.firstName}"
            rendered="#{searchBacking.searchOption eq 'searchByName'}" />

          <syn:input id="lName" label="Last Name" value="#{searchBacking.lastName}"
            rendered="#{searchBacking.searchOption eq 'searchByName'}" required="true"
            requiredMessage="Name field cannot be blank." />

          <syn:input id="searchDateFrom" value="#{searchBacking.searchDateFrom}"
            label="Search Date From" rendered="#{searchBacking.searchOption eq 'searchByDate'}"
            required="true" requiredMessage="Please enter a valid date. For example 04/10/2019">
            <f:convertDateTime type="localDate" pattern="MM/dd/yyyy" />
          </syn:input>

          <syn:input id="searchDateTo" value="#{searchBacking.searchDateTo}" label="Search Date To"
            rendered="#{searchBacking.searchOption eq 'searchByDate'}" required="true"
            requiredMessage="Please enter a valid date. For example 04/10/2019">
            <f:convertDateTime type="localDate" pattern="MM/dd/yyyy" />
          </syn:input>

          <syn:input id="searchID" value="#{searchBacking.customerID}" label="ID"
            rendered="#{searchBacking.searchOption eq 'searchByID'}" required="true"
            requiredMessage="ID field cannot be blank.">
            <f:validateLongRange minimum="1" maximum="1000000000" />
          </syn:input>
        </h:panelGroup>

        <h:panelGroup layout="block" styleClass="header-dropdown search" id="searchButtonPanel">
          <h:commandButton styleClass="header-search tab" id="submitBtn" value="Search"
            action="#{searchBacking.search}">
            <f:ajax execute="@form" render="@form :resultsPanel userMsgs grwl" />
          </h:commandButton>
          <h:commandButton styleClass="header-search tab" type="reset" id="resetBtn" value="Refresh" />
        </h:panelGroup>
      </h:form>
    </div>
  </ui:define>

  <ui:define name="content-stuff">
    <div class="conwrap">
      
      <h:panelGroup id="msgs" layout="block" rendered="{not empty facesContext.messageList}">
        <h:messages id="userMsgs" infoClass="info messages" errorClass="error messages" />
      </h:panelGroup>
        
      <h:panelGroup id="grwl" layout="block">
        <h:outputText value="No Matching Records Found."
          rendered="#{empty searchBacking.values and !facesContext.validationFailed}"
          styleClass="alert messages" />
      </h:panelGroup>

      <h:panelGroup id="resultsPanel" layout="block">
        <h:form id="editTable">

          <h:dataTable id="someTable" value="#{searchBacking.values}" var="c"
            rendered="#{!empty searchBacking.values}" styleClass="data-table">
            <h:column>
              <h:commandLink value="Edit" action="#{searchBacking.edit(c)}" styleClass="tab" />
              <h:commandLink value="Save" action="#{customerManager.update(c)}" rendered="#{c.editable}" styleClass="tab" />
            </h:column>

            <h:column>
              <f:facet name="header">ID</f:facet>
              <h:link outcome="customer" value="#{c.customerID}" includeViewParams="true">
                <f:param name="custid" value="#{c.customerID}" />
              </h:link>
            </h:column>

            <h:column>
              <f:facet name="header">Status</f:facet>
            #{c.statusCode}
          </h:column>

            <h:column>
              <f:facet name="header">First Name</f:facet>
              <h:outputText value="#{c.firstName}" rendered="#{!c.editable}" />
              <h:inputText value="#{c.firstName}" rendered="#{c.editable}" size="10" />
          </h:column>

            <h:column>
              <f:facet name="header">Last Name</f:facet>
              #{c.lastName}
          </h:column>

            <h:column>
              <f:facet name="header">Street Address</f:facet>
            #{c.streetAddress}
          </h:column>

            <h:column>
              <f:facet name="header">City</f:facet>
            #{c.city}
          </h:column>

            <h:column>
              <f:facet name="header">State</f:facet>
            #{c.state}
          </h:column>

            <h:column>
              <f:facet name="header">Zip</f:facet>
            #{c.zipCode}
          </h:column>

            <h:column>
              <f:facet name="header">Email</f:facet>
            #{c.email}
          </h:column>

            <h:column>
              <f:facet name="header">Phone</f:facet>
            #{c.phone}
          </h:column>

            <h:column>
              <f:facet name="header">Date Created</f:facet>
              <h:outputText value="#{c.createdTime}">
                <f:convertDateTime type="localDateTime" pattern="MM/dd/yyyy HH:mm:ss" />
              </h:outputText>
            </h:column>

            <h:column>
              <f:facet name="header">Date Updated</f:facet>
              <h:outputText value="#{c.lastUpdatedTime}">
                <f:convertDateTime type="localDateTime" pattern="MM/dd/yyyy HH:mm:ss" />
              </h:outputText>
            </h:column>
          </h:dataTable>
        </h:form>
      </h:panelGroup>

    </div>
  </ui:define>
</ui:composition>